var express = require('express');
var app = express.Router();
/*
 * GET home page.
 */

app.get('/', function(req,res){
	res.render('gamblinghome',{givenTitle:"Gambling4em",givenStyle:"/stylesheets/gamblinghome.css",
		givenScript:"/javascripts/gamblinghome.js"});
});

app.get('/createbet', function(req,res){
	res.redirect('/');
});

//POST REQUESTS
app.post('/creategrouppage', function(req,res){
	res.render('gamblingcreategroup', {givenTitle:"Gambling4em", givenStyle:"/stylesheets/gamblinghome.css",
			givenScript:"/javascripts/gamblingcreategroup.js"})
});

app.post('/joingrouppage', function(req,res){
	res.render('gamblingjoingroup', {givenTitle:"Gambling4em", givenStyle:"/stylesheets/gamblinghome.css",
			givenScript:"/javascripts/gamblingcreategroup.js"})
});

app.post('/creategroup', function(req, res){
	var groupName = req.body.groupName;
	Group.addGroup(groupName, function(err, group){
		if (err) throw (err);
		res.render('gamblinggroup',{givenTitle:groupName, givenStyle:"/stylesheets/gamblinghome.css",
			givenScript:"/javascripts/gamblinggroup.js"});
	});
});

app.post('/joingroup', function(req,res){
	var groupName = req.body.groupName;
	Group.findGroupEvents(groupName, function(err, eventIDArray, eventNameArray, eventCreatorArray, optionIDArray, optionNameArray){
		if (err) throw (err);
		res.render('gamblinggroupfound', {givenTitle:groupName, givenStyle:"/stylesheets/gamblinghome.css",
			givenScript:"/javascripts/gamblinggroup.js", eventss:evns});
	});
});

app.post('/createeventpage', function(req, res){
	var groupName = req.body.groupName;
	res.render('gamblingcreateevent',{givenTitle:"Create Event", givenStyle:"/stylesheets/gamblinghome.css",
		givenScript:"/javascripts/gamblinggroup.js", groupName:groupName});
});

app.post('/createevent',function(req,res){
	var options = [];
	var groupName = req.body.groupName,
		eventName= req.body.eventName,
		eventCreator = req.body.eventCreator;
	options[0] = req.body.option1;
	options[1] = req.body.option2;
	Group.addEvent(groupName, eventName, eventCreator, options, function(err, group){
		if (err) {
			console.log(err);
			res.redirect('/');
		}
		res.render('gamblingevent',{givenTitle:eventName, groupName:groupName, eventName:eventName, 
			eventCreator:eventCreator, opt1:options[0], opt2:options[1], givenStyle:"/stylesheets/gamblinggroup.css",
			givenScript:"/javascripts/gamblinggroup.js"});
	});
});

app.post('/createbet',function(req,res){
	var groupName= req.body.groupName,
	    eventName= req.body.eventName,
	    team= req.body.team,
	    amount = req.body.amount,
		better=req.body.better,
		address=req.body.address;

	Group.addBet(groupName, eventName, better, address, amount, team, function(err, group){
		if (err) throw (err);
		res.redirect('/')
	});
});

module.exports=router;